<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#0f172a">
    <meta name="description" content="Sync Planner - Integrasi Perencanaan Harian Islami & Manajemen Tugas dengan Kanban Board">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Sync Planner">
    
    <title>Sync Planner + Kanban Board</title>
    
    <link rel="manifest" href="manifest.json">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ¯</text></svg>">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&family=Amiri:wght@400;700&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <button class="theme-toggle" id="theme-toggle" onclick="toggleTheme()" aria-label="Toggle dark mode">
        <span class="theme-icon">ğŸŒ™</span>
    </button>

    <div class="pwa-install-banner" id="pwa-install-banner">
        <div class="pwa-install-info">
            <span class="pwa-install-icon">ğŸ“±</span>
            <div class="pwa-install-text">
                <h4>Install Sync Planner</h4>
                <p>Akses offline & pengalaman lebih baik</p>
            </div>
        </div>
        <div class="pwa-install-actions">
            <button class="pwa-btn pwa-btn-dismiss" onclick="dismissPWABanner()">Nanti</button>
            <button class="pwa-btn pwa-btn-install" onclick="installPWA()">Install</button>
        </div>
    </div>

    <div class="container">
        <!-- Header with Sync Status -->
        <header class="header">
            <div class="header-content">
                <div class="header-brand">
                    <span class="header-icon">ğŸ¯</span>
                    <div>
                        <h1>Sync Planner</h1>
                        <p class="header-tagline">Produktivitas Berbasis Ibadah</p>
                    </div>
                </div>
                
                <!-- Sync Control in Header -->
                <div class="header-actions">
                    <div class="sync-status-btn" id="sync-status-btn" onclick="toggleSyncPanel()">
                        <span class="sync-icon" id="sync-icon">ğŸ”„</span>
                        <span class="sync-label" id="sync-label">Offline</span>
                    </div>
                    <div class="header-date" id="current-date"></div>
                </div>
            </div>
            
            <!-- Sync Panel (expandable) -->
            <div class="sync-panel" id="sync-panel">
                <div class="sync-panel-content">
                    <div class="sync-panel-header">
                        <h3>ğŸ”„ Sinkronisasi</h3>
                        <button class="sync-panel-close" onclick="toggleSyncPanel()">âœ•</button>
                    </div>
                    <div class="sync-panel-body">
                        <div class="sync-toggle-row">
                            <label class="sync-toggle-label">
                                <input type="checkbox" id="header-auto-sync" onchange="updateAutoSyncFromHeader()">
                                <span>Auto Sync</span>
                            </label>
                            <select id="header-sync-interval" onchange="updateAutoSyncFromHeader()">
                                <option value="1">1 menit</option>
                                <option value="5" selected>5 menit</option>
                                <option value="10">10 menit</option>
                                <option value="15">15 menit</option>
                            </select>
                        </div>
                        <div class="sync-info-row">
                            <span>Terakhir sync:</span>
                            <span id="header-last-sync">Belum pernah</span>
                        </div>
                        <div class="sync-actions-row">
                            <button class="btn-sync-now" onclick="manualSync()">
                                <span>ğŸ”„</span> Sync Sekarang
                            </button>
                        </div>
                        <div class="sync-connection-row" id="sync-connection-row">
                            <span id="header-connection-text">âšª Belum terhubung</span>
                            <button class="btn-sync-settings" onclick="switchTab('settings'); toggleSyncPanel();">âš™ï¸</button>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <!-- Navigation -->
        <nav class="nav-tabs">
            <button class="nav-tab active" data-tab="planner" onclick="switchTab('planner')">
                <span class="nav-icon">ğŸ“…</span>
                <span class="nav-text">Planner</span>
            </button>
            <button class="nav-tab" data-tab="pomodoro" onclick="switchTab('pomodoro')">
                <span class="nav-icon">ğŸ…</span>
                <span class="nav-text">Pomodoro</span>
            </button>
            <button class="nav-tab" data-tab="pairwise" onclick="switchTab('pairwise')">
                <span class="nav-icon">âš–ï¸</span>
                <span class="nav-text">Prioritas</span>
            </button>
            <button class="nav-tab" data-tab="kanban" onclick="switchTab('kanban')">
                <span class="nav-icon">ğŸ“‹</span>
                <span class="nav-text">Kanban</span>
            </button>
            <button class="nav-tab" data-tab="progress" onclick="switchTab('progress')">
                <span class="nav-icon">ğŸ“Š</span>
                <span class="nav-text">Progres</span>
            </button>
            <button class="nav-tab" data-tab="settings" onclick="switchTab('settings')">
                <span class="nav-icon">âš™ï¸</span>
                <span class="nav-text">Settings</span>
            </button>
        </nav>

        <!-- ==================== PLANNER TAB ==================== -->
        <div id="planner-tab" class="tab-content active">
            <div class="planner-grid">
                <!-- Morning Routine -->
                <div class="card">
                    <div class="card-header">
                        <div class="card-icon icon-tahajud">ğŸŒ™</div>
                        <h2 class="card-title">Rutinitas Tahajud & Subuh</h2>
                    </div>
                    
                    <div class="time-block">
                        <span class="time-label">03:30</span>
                        <div class="time-content">
                            <div class="time-title">Bangun Tahajud</div>
                            <div class="time-desc">Wudhu, sholat tahajud 2-8 rakaat</div>
                        </div>
                    </div>
                    <div class="time-block">
                        <span class="time-label">04:00</span>
                        <div class="time-content">
                            <div class="time-title">Dzikir & Doa</div>
                            <div class="time-desc">Istighfar, tasbih, tawakkal</div>
                        </div>
                    </div>
                    <div class="time-block">
                        <span class="time-label">04:30</span>
                        <div class="time-content">
                            <div class="time-title">Sholat Subuh</div>
                            <div class="time-desc">Berjamaah + dzikir pagi</div>
                        </div>
                    </div>
                    <div class="time-block">
                        <span class="time-label">05:00</span>
                        <div class="time-content">
                            <div class="time-title">Refleksi Stoic</div>
                            <div class="time-desc">Premeditatio malorum, journaling</div>
                        </div>
                    </div>
                </div>

                <!-- Deep Work Sessions -->
                <div class="card">
                    <div class="card-header">
                        <div class="card-icon icon-pomodoro">ğŸ…</div>
                        <h2 class="card-title">Sesi Deep Work</h2>
                    </div>
                    
                    <div class="deep-work-mini-timer">
                        <div class="dw-mini-display">
                            <span class="dw-mini-time" id="planner-timer">25:00</span>
                            <span class="dw-mini-mode" id="planner-mode">Ready</span>
                        </div>
                        <div class="dw-mini-stats">
                            <span>ğŸ… <strong id="planner-pomodoros">0</strong></span>
                            <span>â±ï¸ <strong id="planner-focus">0m</strong></span>
                        </div>
                    </div>
                    
                    <div class="deep-work-sessions">
                        <div class="dw-session" data-session="1">
                            <div class="dw-session-left">
                                <span class="dw-session-num">ğŸ… 1</span>
                                <input type="text" class="dw-task-input" id="dw-task-1" placeholder="Tugas sesi 1..." onchange="saveDeepWorkTasks()">
                            </div>
                            <div class="dw-session-right">
                                <span class="dw-status" id="dw-status-1">â¸ï¸</span>
                                <button class="dw-start-btn" onclick="startDeepWorkSession(1)">â–¶ï¸</button>
                            </div>
                        </div>
                        <div class="dw-session" data-session="2">
                            <div class="dw-session-left">
                                <span class="dw-session-num">ğŸ… 2</span>
                                <input type="text" class="dw-task-input" id="dw-task-2" placeholder="Tugas sesi 2..." onchange="saveDeepWorkTasks()">
                            </div>
                            <div class="dw-session-right">
                                <span class="dw-status" id="dw-status-2">â¸ï¸</span>
                                <button class="dw-start-btn" onclick="startDeepWorkSession(2)">â–¶ï¸</button>
                            </div>
                        </div>
                        <div class="dw-session" data-session="3">
                            <div class="dw-session-left">
                                <span class="dw-session-num">ğŸ… 3</span>
                                <input type="text" class="dw-task-input" id="dw-task-3" placeholder="Tugas sesi 3..." onchange="saveDeepWorkTasks()">
                            </div>
                            <div class="dw-session-right">
                                <span class="dw-status" id="dw-status-3">â¸ï¸</span>
                                <button class="dw-start-btn" onclick="startDeepWorkSession(3)">â–¶ï¸</button>
                            </div>
                        </div>
                        <div class="dw-session" data-session="4">
                            <div class="dw-session-left">
                                <span class="dw-session-num">ğŸ… 4</span>
                                <input type="text" class="dw-task-input" id="dw-task-4" placeholder="Tugas sesi 4..." onchange="saveDeepWorkTasks()">
                            </div>
                            <div class="dw-session-right">
                                <span class="dw-status" id="dw-status-4">â¸ï¸</span>
                                <button class="dw-start-btn" onclick="startDeepWorkSession(4)">â–¶ï¸</button>
                            </div>
                        </div>
                    </div>
                    
                    <p class="deep-work-hint">ğŸ’¡ Klik â–¶ï¸ untuk mulai timer, otomatis pindah ke tab Pomodoro</p>
                </div>

                <!-- Daily Checklist -->
                <div class="card">
                    <div class="card-header">
                        <div class="card-icon icon-morning">â˜€ï¸</div>
                        <h2 class="card-title">Checklist Harian</h2>
                    </div>
                    
                    <div id="checklist-container">
                        <div class="checklist-item" onclick="toggleCheck(this)" data-index="0">
                            <div class="checkbox">âœ“</div>
                            <span class="check-text">Tahajud minimal 2 rakaat</span>
                        </div>
                        <div class="checklist-item" onclick="toggleCheck(this)" data-index="1">
                            <div class="checkbox">âœ“</div>
                            <span class="check-text">Sholat Subuh berjamaah</span>
                        </div>
                        <div class="checklist-item" onclick="toggleCheck(this)" data-index="2">
                            <div class="checkbox">âœ“</div>
                            <span class="check-text">Dzikir pagi</span>
                        </div>
                        <div class="checklist-item" onclick="toggleCheck(this)" data-index="3">
                            <div class="checkbox">âœ“</div>
                            <span class="check-text">Olahraga 15-30 menit</span>
                        </div>
                        <div class="checklist-item" onclick="toggleCheck(this)" data-index="4">
                            <div class="checkbox">âœ“</div>
                            <span class="check-text">4 Sesi Deep Work</span>
                        </div>
                        <div class="checklist-item" onclick="toggleCheck(this)" data-index="5">
                            <div class="checkbox">âœ“</div>
                            <span class="check-text">Sholat Dzuhur</span>
                        </div>
                        <div class="checklist-item" onclick="toggleCheck(this)" data-index="6">
                            <div class="checkbox">âœ“</div>
                            <span class="check-text">Sholat Ashar</span>
                        </div>
                        <div class="checklist-item" onclick="toggleCheck(this)" data-index="7">
                            <div class="checkbox">âœ“</div>
                            <span class="check-text">Dzikir petang</span>
                        </div>
                        <div class="checklist-item" onclick="toggleCheck(this)" data-index="8">
                            <div class="checkbox">âœ“</div>
                            <span class="check-text">Sholat Maghrib</span>
                        </div>
                        <div class="checklist-item" onclick="toggleCheck(this)" data-index="9">
                            <div class="checkbox">âœ“</div>
                            <span class="check-text">Sholat Isya</span>
                        </div>
                    </div>
                    
                    <div class="progress-bar">
                        <div class="progress-fill" id="progress-fill"></div>
                    </div>
                    <div class="progress-label">
                        <span>Progres Hari Ini</span>
                        <span id="progress-text">0%</span>
                    </div>
                </div>

                <!-- Reflections -->
                <div class="card">
                    <div class="card-header">
                        <div class="card-icon icon-reflection">ğŸ“</div>
                        <h2 class="card-title">Refleksi & Catatan</h2>
                    </div>
                    
                    <div class="reflection-grid">
                        <div class="reflection-item">
                            <label class="reflection-label">ğŸ¯ Apa yang berjalan baik?</label>
                            <textarea class="reflection-input" id="reflection-good" placeholder="Pencapaian positif..." onchange="saveReflections()"></textarea>
                        </div>
                        <div class="reflection-item">
                            <label class="reflection-label">âš¡ Apa yang bisa diperbaiki?</label>
                            <textarea class="reflection-input" id="reflection-improve" placeholder="Area perbaikan..." onchange="saveReflections()"></textarea>
                        </div>
                        <div class="reflection-item">
                            <label class="reflection-label">ğŸ™ Syukur (Gratitude)</label>
                            <textarea class="reflection-input" id="reflection-gratitude" placeholder="3 hal disyukuri..." onchange="saveReflections()"></textarea>
                        </div>
                        <div class="reflection-item">
                            <label class="reflection-label">ğŸ’­ Sedona: Lepaskan</label>
                            <textarea class="reflection-input" id="reflection-sedona" placeholder="Apa yang dilepaskan?" onchange="saveReflections()"></textarea>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ==================== POMODORO TAB ==================== -->
        <div id="pomodoro-tab" class="tab-content">
            <div class="planner-grid">
                <div class="card">
                    <div class="card-header">
                        <div class="card-icon icon-pomodoro">ğŸ…</div>
                        <h2 class="card-title">Pomodoro Timer</h2>
                    </div>
                    
                    <div class="current-task-box" id="current-task-box">
                        <span class="current-task-label">Tugas saat ini:</span>
                        <span class="current-task-name" id="current-task-name">Tidak ada tugas</span>
                    </div>
                    
                    <div class="timer-modes">
                        <button class="mode-btn active" data-mode="work" onclick="setTimerMode('work')">ğŸ¯ Deep Work</button>
                        <button class="mode-btn" data-mode="short-break" onclick="setTimerMode('short-break')">â˜• Istirahat</button>
                        <button class="mode-btn" data-mode="long-break" onclick="setTimerMode('long-break')">ğŸ§˜ Panjang</button>
                    </div>
                    
                    <div class="timer-container">
                        <svg class="timer-ring" viewBox="0 0 280 280">
                            <circle class="timer-ring-bg" cx="140" cy="140" r="130"></circle>
                            <circle class="timer-ring-progress work" id="timer-progress" cx="140" cy="140" r="130"></circle>
                        </svg>
                        <div class="timer-display">
                            <span class="timer-time" id="timer-display">25:00</span>
                            <span class="timer-mode" id="timer-mode-label">Deep Work</span>
                        </div>
                    </div>
                    
                    <div class="timer-controls">
                        <button class="timer-btn" id="btn-timer-start" onclick="startTimer()">â–¶ï¸ Mulai</button>
                        <button class="timer-btn" id="btn-timer-pause" onclick="pauseTimer()" style="display: none;">â¸ï¸ Pause</button>
                        <button class="timer-btn secondary" onclick="resetTimer()">ğŸ”„ Reset</button>
                        <button class="timer-btn secondary" onclick="skipTimer()">â­ï¸ Skip</button>
                    </div>
                    
                    <p class="session-info" id="session-info">Sesi 1 dari 4 ğŸ…</p>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-icon icon-guide">ğŸ“Š</div>
                        <h2 class="card-title">Statistik Hari Ini</h2>
                    </div>
                    
                    <div class="stats-grid">
                        <div class="stat-item">
                            <span class="stat-value" id="stat-pomodoros">0</span>
                            <span class="stat-label">Pomodoro</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-value" id="stat-focus-time">0m</span>
                            <span class="stat-label">Fokus</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-value" id="stat-breaks">0</span>
                            <span class="stat-label">Istirahat</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-value" id="stat-streak">0</span>
                            <span class="stat-label">Streak</span>
                        </div>
                    </div>
                    
                    <div class="session-progress">
                        <h4>Progres Sesi</h4>
                        <div class="session-dots">
                            <div class="session-dot" id="session-dot-1">1</div>
                            <div class="session-dot" id="session-dot-2">2</div>
                            <div class="session-dot" id="session-dot-3">3</div>
                            <div class="session-dot" id="session-dot-4">4</div>
                        </div>
                    </div>
                </div>

                <div class="card card-full">
                    <div class="card-header">
                        <div class="card-icon icon-settings">âš™ï¸</div>
                        <h2 class="card-title">Pengaturan Timer</h2>
                    </div>
                    
                    <div class="settings-grid">
                        <div class="setting-item">
                            <label>ğŸ¯ Deep Work (menit)</label>
                            <input type="number" id="setting-work" value="25" min="1" max="120" onchange="updateTimerSettings()">
                        </div>
                        <div class="setting-item">
                            <label>â˜• Istirahat Pendek</label>
                            <input type="number" id="setting-short-break" value="5" min="1" max="30" onchange="updateTimerSettings()">
                        </div>
                        <div class="setting-item">
                            <label>ğŸ§˜ Istirahat Panjang</label>
                            <input type="number" id="setting-long-break" value="15" min="1" max="60" onchange="updateTimerSettings()">
                        </div>
                    </div>
                    
                    <div class="sound-settings">
                        <h4>ğŸ”Š Pengaturan Suara</h4>
                        <div class="sound-toggle">
                            <label><input type="checkbox" id="sound-enabled" checked onchange="updateSoundSettings()"> Aktifkan notifikasi suara</label>
                        </div>
                        <div class="sound-volume">
                            <label>Volume</label>
                            <input type="range" id="sound-volume" min="0" max="100" value="50" onchange="updateSoundSettings()">
                        </div>
                        <button class="btn-secondary" onclick="testSound()">ğŸ”” Test Suara</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- ==================== PAIRWISE TAB ==================== -->
        <div id="pairwise-tab" class="tab-content">
            <div class="planner-grid">
                <div class="card">
                    <div class="card-header">
                        <div class="card-icon icon-input">ğŸ“</div>
                        <h2 class="card-title">Input Opsi</h2>
                    </div>
                    
                    <p class="card-desc">Masukkan opsi yang ingin dibandingkan (3-10 item)</p>
                    
                    <div class="input-group">
                        <input type="text" class="option-input" id="option-input" placeholder="Ketik opsi..." onkeypress="handleOptionKeypress(event)">
                        <button class="btn-primary" onclick="addOption()">â•</button>
                    </div>
                    
                    <div class="options-list" id="options-list">
                        <div class="empty-state">
                            <span>ğŸ“</span>
                            <p>Tambahkan minimal 3 opsi.</p>
                        </div>
                    </div>
                    
                    <div class="options-actions">
                        <span class="options-count" id="options-count">0 opsi</span>
                        <button class="btn-secondary" onclick="clearAllOptions()">ğŸ—‘ï¸</button>
                        <button class="btn-primary" id="btn-start-comparison" onclick="startComparison()" disabled>â–¶ï¸ Mulai</button>
                    </div>
                </div>

                <div class="card" id="comparison-card" style="display: none;">
                    <div class="card-header">
                        <div class="card-icon icon-compare">âš–ï¸</div>
                        <h2 class="card-title">Pilih yang Lebih Penting</h2>
                    </div>
                    
                    <div class="comparison-progress">
                        <div class="comparison-progress-bar">
                            <div class="comparison-progress-fill" id="comparison-progress-fill"></div>
                        </div>
                        <span class="comparison-progress-text" id="comparison-progress-text">0 / 0</span>
                    </div>
                    
                    <div class="comparison-options">
                        <button class="comparison-btn" onclick="selectOption('a')">
                            <span class="comparison-text" id="option-text-a">Opsi A</span>
                        </button>
                        <div class="comparison-vs">VS</div>
                        <button class="comparison-btn" onclick="selectOption('b')">
                            <span class="comparison-text" id="option-text-b">Opsi B</span>
                        </button>
                    </div>
                </div>

                <div class="card" id="results-card" style="display: none;">
                    <div class="card-header">
                        <div class="card-icon icon-results">ğŸ†</div>
                        <h2 class="card-title">Hasil Prioritas</h2>
                    </div>
                    
                    <div class="results-list" id="results-list"></div>
                    
                    <div class="results-actions">
                        <button class="btn-secondary" onclick="resetComparison()">ğŸ”„ Ulang</button>
                        <button class="btn-primary" onclick="addResultsToKanban()">ğŸ“‹ Ke Kanban</button>
                        <button class="btn-primary" onclick="addResultsToDeepWork()">ğŸ… Ke Deep Work</button>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-icon icon-guide">ğŸ’¡</div>
                        <h2 class="card-title">Cara Kerja</h2>
                    </div>
                    <div class="guide-steps">
                        <div class="guide-step"><span class="step-number">1</span><div class="step-content"><strong>Tambah Opsi</strong><p>Minimal 3 opsi</p></div></div>
                        <div class="guide-step"><span class="step-number">2</span><div class="step-content"><strong>Bandingkan</strong><p>Pilih yang lebih penting</p></div></div>
                        <div class="guide-step"><span class="step-number">3</span><div class="step-content"><strong>Hasil</strong><p>Urutan prioritas</p></div></div>
                        <div class="guide-step"><span class="step-number">4</span><div class="step-content"><strong>Terapkan</strong><p>Ke Kanban / Deep Work</p></div></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ==================== KANBAN TAB ==================== -->
        <div id="kanban-tab" class="tab-content">
            <div class="kanban-quick-add">
                <input type="text" class="quick-task-input" id="quick-task-input" placeholder="Tambah tugas baru..." onkeypress="handleQuickTaskKeypress(event)">
                <select class="quick-task-priority" id="quick-task-priority">
                    <option value="high">ğŸ”´ Tinggi</option>
                    <option value="medium" selected>ğŸŸ¡ Sedang</option>
                    <option value="low">ğŸŸ¢ Rendah</option>
                </select>
                <button class="btn-primary" onclick="quickAddTask()">â•</button>
            </div>

            <div class="kanban-stats">
                <div class="kanban-stat"><span class="kanban-stat-value" id="stat-total">0</span><span class="kanban-stat-label">Total</span></div>
                <div class="kanban-stat"><span class="kanban-stat-value" id="stat-in-progress">0</span><span class="kanban-stat-label">Progress</span></div>
                <div class="kanban-stat"><span class="kanban-stat-value" id="stat-done">0</span><span class="kanban-stat-label">Selesai</span></div>
            </div>

            <div class="kanban-board">
                <div class="kanban-column">
                    <div class="column-header"><h3>ğŸ“¥ Backlog</h3><span class="column-count" id="count-backlog">0</span></div>
                    <div class="column-content" id="column-backlog" ondragover="handleDragOver(event)" ondrop="handleDrop(event, 'backlog')"></div>
                </div>
                <div class="kanban-column">
                    <div class="column-header"><h3>ğŸ“‹ To Do</h3><span class="column-count" id="count-todo">0</span></div>
                    <div class="column-content" id="column-todo" ondragover="handleDragOver(event)" ondrop="handleDrop(event, 'todo')"></div>
                </div>
                <div class="kanban-column">
                    <div class="column-header"><h3>ğŸ”„ Progress</h3><span class="column-count" id="count-inprogress">0</span></div>
                    <div class="column-content" id="column-inprogress" ondragover="handleDragOver(event)" ondrop="handleDrop(event, 'inprogress')"></div>
                </div>
                <div class="kanban-column">
                    <div class="column-header"><h3>âœ… Done</h3><span class="column-count" id="count-done">0</span></div>
                    <div class="column-content" id="column-done" ondragover="handleDragOver(event)" ondrop="handleDrop(event, 'done')"></div>
                </div>
            </div>
        </div>

        <!-- ==================== PROGRESS TAB ==================== -->
        <div id="progress-tab" class="tab-content">
            <div class="planner-grid">
                <div class="card card-full">
                    <div class="card-header">
                        <div class="card-icon icon-guide">ğŸ“Š</div>
                        <h2 class="card-title">Rekap Progres</h2>
                    </div>
                    <div class="period-selector">
                        <button class="period-btn active" data-period="week" onclick="showProgress('week')">ğŸ“… 1 Minggu</button>
                        <button class="period-btn" data-period="month" onclick="showProgress('month')">ğŸ“† 1 Bulan</button>
                        <button class="period-btn" data-period="quarter" onclick="showProgress('quarter')">ğŸ“Š 3 Bulan</button>
                        <button class="period-btn" data-period="year" onclick="showProgress('year')">ğŸ“ˆ 1 Tahun</button>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-icon icon-pomodoro">ğŸ¯</div>
                        <h2 class="card-title">Ringkasan</h2>
                    </div>
                    <div class="progress-summary">
                        <div class="summary-item"><span class="summary-value" id="summary-tasks-completed">0</span><span class="summary-label">Tugas Selesai</span></div>
                        <div class="summary-item"><span class="summary-value" id="summary-pomodoros">0</span><span class="summary-label">Pomodoro</span></div>
                        <div class="summary-item"><span class="summary-value" id="summary-focus-hours">0h</span><span class="summary-label">Waktu Fokus</span></div>
                        <div class="summary-item"><span class="summary-value" id="summary-checklist-avg">0%</span><span class="summary-label">Avg Checklist</span></div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-icon icon-tahajud">ğŸ•Œ</div>
                        <h2 class="card-title">Statistik Ibadah</h2>
                    </div>
                    <div class="ibadah-stats">
                        <div class="ibadah-item"><span class="ibadah-icon">ğŸŒ™</span><div class="ibadah-info"><span class="ibadah-name">Tahajud</span><div class="ibadah-bar"><div class="ibadah-fill" id="ibadah-tahajud"></div></div></div><span class="ibadah-percent" id="ibadah-tahajud-pct">0%</span></div>
                        <div class="ibadah-item"><span class="ibadah-icon">â˜€ï¸</span><div class="ibadah-info"><span class="ibadah-name">Subuh</span><div class="ibadah-bar"><div class="ibadah-fill" id="ibadah-subuh"></div></div></div><span class="ibadah-percent" id="ibadah-subuh-pct">0%</span></div>
                        <div class="ibadah-item"><span class="ibadah-icon">ğŸ“¿</span><div class="ibadah-info"><span class="ibadah-name">Dzikir Pagi</span><div class="ibadah-bar"><div class="ibadah-fill" id="ibadah-dzikir-pagi"></div></div></div><span class="ibadah-percent" id="ibadah-dzikir-pagi-pct">0%</span></div>
                        <div class="ibadah-item"><span class="ibadah-icon">ğŸŒ…</span><div class="ibadah-info"><span class="ibadah-name">Dzikir Petang</span><div class="ibadah-bar"><div class="ibadah-fill" id="ibadah-dzikir-petang"></div></div></div><span class="ibadah-percent" id="ibadah-dzikir-petang-pct">0%</span></div>
                        <div class="ibadah-item"><span class="ibadah-icon">ğŸ…</span><div class="ibadah-info"><span class="ibadah-name">Deep Work</span><div class="ibadah-bar"><div class="ibadah-fill" id="ibadah-deepwork"></div></div></div><span class="ibadah-percent" id="ibadah-deepwork-pct">0%</span></div>
                    </div>
                </div>

                <div class="card card-full">
                    <div class="card-header">
                        <div class="card-icon icon-morning">ğŸ“ˆ</div>
                        <h2 class="card-title">Trend Harian</h2>
                    </div>
                    <div class="trend-chart" id="trend-chart"></div>
                </div>

                <div class="card card-full">
                    <div class="card-header">
                        <div class="card-icon icon-log">ğŸ“œ</div>
                        <h2 class="card-title">Riwayat Harian</h2>
                    </div>
                    <div class="history-list" id="history-list">
                        <div class="empty-state"><span>ğŸ“Š</span><p>Belum ada data riwayat.</p></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ==================== SETTINGS TAB ==================== -->
        <div id="settings-tab" class="tab-content">
            <div class="planner-grid">
                <div class="card card-full">
                    <div class="card-header">
                        <div class="card-icon icon-gsheet">ğŸ“Š</div>
                        <h2 class="card-title">Google Sheets Setup</h2>
                    </div>
                    <div class="setup-steps">
                        <div class="setup-step"><span class="step-number">1</span><div class="step-content"><strong>Buat Google Sheet</strong><p><a href="https://sheets.google.com" target="_blank">sheets.google.com</a></p></div></div>
                        <div class="setup-step"><span class="step-number">2</span><div class="step-content"><strong>Extensions â†’ Apps Script</strong></div></div>
                        <div class="setup-step"><span class="step-number">3</span><div class="step-content"><strong>Paste kode</strong><button class="btn-secondary" onclick="toggleAppsScript()">ğŸ“ Lihat</button><button class="btn-primary" onclick="copyAppsScript()">ğŸ“‹ Copy</button></div></div>
                        <div class="setup-step"><span class="step-number">4</span><div class="step-content"><strong>Deploy â†’ Web app</strong><p>Execute as: Me, Who: Anyone</p></div></div>
                    </div>
                    <div class="apps-script-code" id="apps-script-code" style="display: none;">
                        <pre class="script-code" id="apps-script-content">// Lihat file Code.gs di repository</pre>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-icon icon-connection">ğŸ”—</div>
                        <h2 class="card-title">Koneksi</h2>
                    </div>
                    <div class="connection-status" id="connection-status">
                        <span class="status-icon">âšª</span>
                        <span class="status-text">Belum terhubung</span>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Web App URL</label>
                        <input type="url" class="form-input" id="gsheet-url" placeholder="https://script.google.com/macros/s/...">
                    </div>
                    <div class="form-actions">
                        <button class="btn-secondary" onclick="testConnection()">ğŸ§ª Test</button>
                        <button class="btn-primary" onclick="saveGSheetSettings()">ğŸ’¾ Simpan</button>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-icon icon-sync">ğŸ”„</div>
                        <h2 class="card-title">Sync Manual</h2>
                    </div>
                    <div class="sync-actions">
                        <div class="sync-item">
                            <div class="sync-info"><h4>ğŸ“‹ Kanban</h4></div>
                            <div class="sync-buttons">
                                <button class="btn-sync" onclick="syncTasksToSheet()">â¬†ï¸</button>
                                <button class="btn-sync" onclick="loadTasksFromSheet()">â¬‡ï¸</button>
                            </div>
                        </div>
                        <div class="sync-item">
                            <div class="sync-info"><h4>ğŸ“… Harian</h4></div>
                            <div class="sync-buttons">
                                <button class="btn-sync" onclick="syncDailyToSheet()">â¬†ï¸</button>
                                <button class="btn-sync" onclick="loadDailyFromSheet()">â¬‡ï¸</button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-icon icon-log">ğŸ“œ</div>
                        <h2 class="card-title">Log Aktivitas</h2>
                    </div>
                    <div class="log-container" id="log-entries">
                        <div class="log-empty">Belum ada aktivitas</div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-icon icon-data">ğŸ’¾</div>
                        <h2 class="card-title">Data</h2>
                    </div>
                    <div class="data-actions">
                        <button class="btn-secondary" onclick="exportAllData()">ğŸ“¤ Export</button>
                        <button class="btn-secondary" onclick="document.getElementById('import-file').click()">ğŸ“¥ Import</button>
                        <input type="file" id="import-file" accept=".json" style="display:none" onchange="importAllData(event)">
                        <button class="btn-danger" onclick="clearAllData()">ğŸ—‘ï¸ Hapus</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modals -->
    <div class="modal-overlay" id="task-modal">
        <div class="modal">
            <h2>âœï¸ Edit Tugas</h2>
            <input type="hidden" id="edit-task-id">
            <input type="text" class="modal-input" id="edit-task-title" placeholder="Judul tugas">
            <select class="modal-select" id="edit-task-priority">
                <option value="high">ğŸ”´ Tinggi</option>
                <option value="medium">ğŸŸ¡ Sedang</option>
                <option value="low">ğŸŸ¢ Rendah</option>
            </select>
            <select class="modal-select" id="edit-task-column">
                <option value="backlog">ğŸ“¥ Backlog</option>
                <option value="todo">ğŸ“‹ To Do</option>
                <option value="inprogress">ğŸ”„ Progress</option>
                <option value="done">âœ… Done</option>
            </select>
            <textarea class="modal-input modal-textarea" id="edit-task-notes" placeholder="Catatan..."></textarea>
            <div class="modal-buttons">
                <button class="modal-btn modal-btn-delete" onclick="deleteTask()">ğŸ—‘ï¸</button>
                <button class="modal-btn modal-btn-cancel" onclick="closeTaskModal()">Batal</button>
                <button class="modal-btn modal-btn-save" onclick="saveTaskEdit()">Simpan</button>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="pairwise-kanban-modal">
        <div class="modal">
            <h2>ğŸ“‹ Tambah ke Kanban</h2>
            <div class="pairwise-list" id="pairwise-kanban-list"></div>
            <div class="modal-buttons">
                <button class="modal-btn modal-btn-cancel" onclick="closePairwiseKanbanModal()">Batal</button>
                <button class="modal-btn modal-btn-save" onclick="confirmAddToKanban()">Tambah</button>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="pairwise-deepwork-modal">
        <div class="modal">
            <h2>ğŸ… Tambah ke Deep Work</h2>
            <p class="modal-desc">Pilih maks 4 untuk sesi Deep Work:</p>
            <div class="pairwise-list" id="pairwise-deepwork-list"></div>
            <div class="modal-buttons">
                <button class="modal-btn modal-btn-cancel" onclick="closePairwiseDeepWorkModal()">Batal</button>
                <button class="modal-btn modal-btn-save" onclick="confirmAddToDeepWork()">Tambah</button>
            </div>
        </div>
    </div>

    <audio id="notification-sound" preload="auto">
        <source src="data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2teleQwHYre51JdyCgNoo8OzkHQJBVmPuLKQfBUIVIS0sJeEFgxOgLCzlYYOAl58qrGxnpQhE1qBprOxnJMdGVp8n6+2ppwlFlqFpqawmJIXFlV5m6W0sZstJk19oaqwpJMRE0x3laGltaA2MU13mamolokMCUp9lZmcoKRKO010lqWdjoYLBEl9kpOWmJlWRlN0laGalY4ODU5+kIySkYxXR1Vzj5eYk5IWFk1+j4qHg3paSlRwjJGRj5IaG01+jYiBdnFhSlVtioqJho0cHEt+i4N1a2VjT1triYWAe4MZHUR8iIF2bWhlWFtnhH94b24TFT17h392cXBrXFxmdXtwaGcTEDl4hXp2dHNtYmJocnJqYWIODTd0gXd0c3VubGtsbm5mXl4MCTR0fXNwcHFwcXFubGRdWQkINXF6cGxqam1vcW9rYl1YCgczcXZsaGZlanBwbmhgW1gJBzJucWllYF5ka2xpZFxYVggHMGxsZ2JdW2BnaGViXVhVCAcvamllXlhYXWRkYV1ZVVMICC5oZmFaVVRaYV9dWlZSUAgILWZiXldTUlhcW1lWUk9NCAgqY15aVFBPVFhXVVJOTEoICClhW1ZRT01RVFNRTktJRwgJKF9YVFBMS09SUEZNR0RHBwknXFVRTkpITU9NSkVDQEQHCSdbUk5LR0VMTUpHQz4+QQcKJVlPTEhFQ0lKR0RBPT06BwsRWE1JRUJASEZDPzw4NwYAB1BJRUI+PENCPzs3MzQHCCFMRT49OjlAPDs2MS0sBgkgSUI7OTY0Ojg1MSwpKAYKH0U+ODYyMTY0Mi0pJiQGDRtAOTQxLi0yMC0pJSIfBw0YOzYwLSsqLiwnJCEeHAcOFDYxLCkoJysnIyAfHRsIEBIxLCgnJSQoJSEeHBkYCBAPLCglIyIhJSEfGxkXFgkRDSklISAdHCEeGxgVExMJEwwlIR4bGRkdGhcUEhAPChYPHx0aFxYWGRYTEA4NDAsLFBcZFhQTFBYTEA4LCggJCxQVEw8ODRANGQ4LCQcGBgsMEA4MCgkNDAwLCQcFBAMGBgkLCgoKCgsLCgkIBgUEBAQFBwkJCQkJCQkJCAcGBQQEBAUGBwgICAcIBwcHBwYGBQUFBQUFBgYGBgYGBgYGBgYGBgYGBQUFBQUFBQUFBQU=" type="audio/wav">
    </audio>

    <script src="app.js"></script>
</body>
</html>
